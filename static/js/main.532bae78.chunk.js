(window["webpackJsonptbf-checklist"]=window["webpackJsonptbf-checklist"]||[]).push([[0],{138:function(e,t,r){"use strict";r.r(t);var a=r(0),c=r.n(a),n=r(14),i=r.n(n);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r(92),r(93);var o=r(26),l=r(27),s=r(47),u="https://api-gw98.herokuapp.com/https://techbookfest.org/api",d=/^(.+?)([0-9]+)(.*)$/,h="circle-cache",m="c:";function f(e){var t=[].concat(d.exec(e)||["",0,""]).slice(1),r=t[0].codePointAt(0);return 1e3*(12353<=r&&r<=12435?r-12353+10:["\u904b","\u5354"].indexOf(t[0]))+ +t[1]}var v=function(){function e(){Object(o.a)(this,e),this._event=new s,this._waitRequest={},this._waitRequestList=!1,this._store=this._getDefault(),sessionStorage.removeItem(h);for(var t=0;t<sessionStorage.length;t++)try{var r=sessionStorage.key(t);if(m===r.substr(0,m.length)){var a=JSON.parse(sessionStorage.getItem(r));a&&a.id&&this._updateCircle(a,!0)}}catch(c){}this._store.orderBy.booth=this._store.orderBy.booth.sort((function(e,t){return f(e)-f(t)}))}return Object(l.a)(e,[{key:"_getDefault",value:function(){return{loadCompleted:!1,orderBy:{booth:[]},lookupBy:{booth:{}},circles:{}}}},{key:"_updateCircle",value:function(e,t){delete e.event,delete e.eventExhibitCourse,this._store.circles[e.id]=e;for(var r,a=0;void 0!==(r=e.spaces[a]);++a)this._store.lookupBy.booth[r]=e.id,this._store.orderBy.booth.indexOf(r)<0&&this._store.orderBy.booth.push(r);t||sessionStorage.setItem(m+e.id,JSON.stringify(e))}},{key:"request",value:function(e){var t=this;(e=e||{}).circleId=e.circleId||null;var r=[],a=!1;if(e.circleId){if(this._waitRequest[e.circleId])return void console.debug("request wait for ".concat(e.circleId));if(this._store.circles[e.circleId])return void console.debug("use cache for ".concat(e.circleId));r.push("".concat(u,"/circle/").concat(e.circleId)),this._waitRequest[e.circleId]=!0,a=e.circleId}else this._waitRequestList=a=!0,this._store.loadCompleted=!1,r.push("".concat(u,"/circle?eventID=").concat("tbf07","&eventExhibitCourseID=3&visibility=site&limit=100&onlyAdoption=true"));!function e(){var c=r.shift();c?fetch(c,{method:"GET"}).then((function(e){return e.json()})).then((function(a){if(a.cursor&&r.unshift("".concat(c.replace(/&cursor=.+$/,""),"&cursor=").concat(a.cursor)),a.list)for(var n,i=0;void 0!==(n=a.list[i]);++i)t._updateCircle(n);else t._updateCircle(a);return t._store.orderBy.booth=t._store.orderBy.booth.sort((function(e,t){return f(e)-f(t)})),t._event.emit("change"),e()})).catch((function(e){return console.error(e)})):(!0===a?(t._waitRequestList=!1,t._store.loadCompleted=!0):delete t._waitRequest[a],t._event.emit("change"),t._event.emit("loaded"))}()}},{key:"on",value:function(e,t){this._event.on(e,t),0<=["change","loaded"].indexOf(e)&&!1===this._waitRequestList&&t(e)}},{key:"off",value:function(e,t){this._event.removeListener(e,t)}},{key:"getCircleListOrderByBooth",value:function(){var e=this;return(this._store.orderBy.booth||[]).map((function(t){return(e.getCircleByBooth(t)||{}).id}))}},{key:"getCircleByBooth",value:function(e){return this._store.circles[this._store.lookupBy.booth[e]]}},{key:"getCircleBoothOrder",value:function(e){return!1!==this._waitRequestList?-2:this._store.orderBy.booth.indexOf(((this._store.circles[e]||{}).spaces||[])[0])}},{key:"getCircle",value:function(e){return this._store.circles[e]}},{key:"getFirstBooth",value:function(){return!1===this._waitRequestList&&this.getCircleByBooth(this._store.orderBy.booth[0])}},{key:"getLastBooth",value:function(){return!1===this._waitRequestList&&this.getCircleByBooth(this._store.orderBy.booth[this._store.orderBy.booth.length-1])}},{key:"hasPrevCircle",value:function(e){var t=this._store.circles[e];return!(!t||!t.prevCircleExhibitInfoID)}},{key:"hasNextCircle",value:function(e){var t=this._store.circles[e];return!(!t||!t.nextCircleExhibitInfoID)}},{key:"getPrevCircle",value:function(e){var t=this._store.circles[e];return t&&t.prevCircleExhibitInfoID&&this._store.circles[t.prevCircleExhibitInfoID]}},{key:"getNextCircle",value:function(e){var t=this._store.circles[e];return t&&t.nextCircleExhibitInfoID&&this._store.circles[t.nextCircleExhibitInfoID]}},{key:"getPrevCircleId",value:function(e){var t=this._store.circles[e];return t&&t.prevCircleExhibitInfoID}},{key:"getNextCircleId",value:function(e){var t=this._store.circles[e];return t&&t.nextCircleExhibitInfoID}},{key:"mergeFavorite",value:function(e){var t=this,r={};e.forEach((function(e){if(e.circleId){var a=t._store.circles[e.circleId];if(!a)return void(r[e.circleId]=!0);e.space=a.spaces[0],e.circleName=a.name}})),Object.keys(r).forEach((function(e){t.request({circleId:e})}))}},{key:"clearCache",value:function(){for(var e=0;e<sessionStorage.length;e++){var t=sessionStorage.key(e);m===t.substr(0,m.length)&&sessionStorage.removeItem(t)}this._store=this._getDefault(),this._event.emit("change")}}]),e}(),p=r(47),g="p:",E=function(){function e(){Object(o.a)(this,e),this._event=new p,this._store=this._getDefault(),this._reqWait={};for(var t=0;t<sessionStorage.length;t++)try{var r=sessionStorage.key(t);if(g===r.substr(0,g.length)){var a=JSON.parse(sessionStorage.getItem(r));a&&a.id&&this._updateCircle(a,!0)}}catch(c){}}return Object(l.a)(e,[{key:"request",value:function(e){var t=this;(e=e||{}).circleId=e.circleId||null;var r=[],a=e.circleId;if(e.circleId)if(this._reqWait[e.circleId])console.debug("request wait for ".concat(e.circleId));else if(this._store.products[e.circleId])console.debug("use cache for ".concat(e.circleId));else{this._reqWait[e.circleId]=!0,r.push("".concat("https://api-gw98.herokuapp.com/https://techbookfest.org/api","/product?circleExhibitInfoID=").concat(e.circleId,"&limit=100"));!function e(){var c=r.shift();c?fetch(c,{method:"GET"}).then((function(e){return e.json()})).then((function(a){if(a.cursor&&r.unshift("".concat(c.replace(/&cursor=.+$/,""),"&cursor=").concat(a.cursor)),a.list)for(var n,i=0;void 0!==(n=a.list[i]);++i)t._updateCircle(n);return t._event.emit("change"),e()})).catch((function(e){return console.error(e)})):(delete t._reqWait[a],t._event.emit("change"),t._event.emit("loaded"))}()}}},{key:"_getDefault",value:function(){return{orderBy:{seq:{}},products:{}}}},{key:"_updateCircle",value:function(e,t){var r=e.circleExhibitInfoID;this._store.products[r]=this._store.products[r]||{},this._store.products[r][e.id]=e,this._store.orderBy.seq[r]=this._store.orderBy.seq[r]||[],this._store.orderBy.seq[r][e.seq-1]=e.id,t||sessionStorage.setItem(g+e.id,JSON.stringify(e))}},{key:"on",value:function(e,t){this._event.on(e,t)}},{key:"off",value:function(e,t){this._event.removeListener(e,t)}},{key:"getProductOrder",value:function(e,t){var r=this._store.orderBy.seq[e]||[];return r?r.indexOf(t):-1}},{key:"getProductList",value:function(e){var t=this._store.products[e];return t&&Object.keys(t)}},{key:"getProductByIndex",value:function(e,t){return(this._store.products[e]||{})[(this._store.orderBy.seq[e]||[])[t]]||!1}},{key:"getProduct",value:function(e,t){return(this._store.products[e]||{})[t]||!1}},{key:"getProductCount",value:function(e){var t=this._store.orderBy.seq[e];return t?t.length:-1}},{key:"hasNextProduct",value:function(e,t){var r=this._store.orderBy.seq[e],a=r&&r.indexOf(t);return!(!r||!r[a+1])}},{key:"getPrevSiblings",value:function(e,t){var r=this._store.products[e],a=this._store.orderBy.seq[e],c=a&&a.indexOf(t);return a&&r[a[c-1]]||!1}},{key:"getNextSiblings",value:function(e,t){var r=this._store.products[e],a=this._store.orderBy.seq[e],c=a&&a.indexOf(t);return a&&r[a[c+1]]||!1}},{key:"mergeFavorite",value:function(e){var t=this,r={};e.forEach((function(e){if(e.circleId&&e.productId){var a=(t._store.products[e.circleId]||{})[e.productId];if(!a)return void(r[e.circleId]=!0);e.productName=a.name,e.productPrice=a.price}})),Object.keys(r).forEach((function(e){t.request({circleId:e})}))}},{key:"clearCache",value:function(){for(var e=0;e<sessionStorage.length;e++){var t=sessionStorage.key(e);g===t.substr(0,g.length)&&sessionStorage.removeItem(t)}this._store=this._getDefault(),this._event.emit("change")}}]),e}(),b=r(58),y=r(47),I=r(94),_="favorite",k=function(){function e(){Object(o.a)(this,e),this._event=new y,this._store=JSON.parse(localStorage.getItem(_)||"{}")}return Object(l.a)(e,[{key:"on",value:function(e,t){this._event.on(e,t)}},{key:"off",value:function(e,t){this._event.removeListener(e,t)}},{key:"isFavorite",value:function(e,t){return!!(t?this._store.tbf07&&this._store.tbf07[e]&&this._store.tbf07[e][t]:this._store.tbf07&&this._store.tbf07[e]&&this._store.tbf07[e].circle)}},{key:"setFavorite",value:function(e,t){if(e){this._store.tbf07=this._store.tbf07||{},this._store.tbf07[e]=this._store.tbf07[e]||Object(b.a)({},"circle",null);var r=t||"circle",a=!0!==this._store.tbf07[e][r];this._store.tbf07[e][r]=!0,a&&(localStorage.setItem(_,JSON.stringify(this._store)),this._event.emit("change",{circleId:e,productId:t,favorite:!0}))}}},{key:"unsetFavorite",value:function(e,t){if(e){this._store.tbf07=this._store.tbf07||{},this._store.tbf07[e]=this._store.tbf07[e]||Object(b.a)({},"circle",null);var r=t||"circle",a=!0===this._store.tbf07[e][r];delete this._store.tbf07[e][r],a&&(localStorage.setItem(_,JSON.stringify(this._store)),this._event.emit("change",{circleId:e,productId:t,favorite:!1}))}}},{key:"export",value:function(){I(JSON.stringify(this._store),"favorite.json")}},{key:"import",value:function(e){try{var t=JSON.parse(e);return this._store=t,localStorage.setItem(_,JSON.stringify(this._store)),this._event.emit("change"),!0}catch(r){return console.debug(r),!1}}},{key:"list",value:function(e){var t=[],r={},a=this._store[e]||{};for(var c in a){var n=a[c]||{};for(var i in n)n[i]&&("circle"===i?t.push({eventId:"tbf07",circleId:c}):(t.push({eventId:"tbf07",circleId:c,productId:i}),r[c]=!0))}return t=t.reduce((function(e,t){return!t.productId&&r[t.circleId]||e.push(t),e}),[])}}]),e}(),C=r(37),O=r(28),N=(r(95),r(77)),w=r(75);var x=function(){return c.a.createElement("div",null,c.a.createElement(O.c,{to:"/7/circle/"}),c.a.createElement(w.LinkContainer,{to:"/7/circle/"},c.a.createElement(N.a,null,"\u6280\u8853\u66f8\u5178\uff17")))},j=r(16),B=r(145),S=r(15),L=r(18),q=r(23),P=r.n(q),F=r(42),D=r.n(F),R=r(9),z=r.n(R),G=r(41);var J=function(e){var t=e.models,r=e.circleId,n=e.productId,i=e.isCurrent,o=t.favorite,l=Object(a.useState)(o.isFavorite(r,n)),s=Object(j.a)(l,2),u=s[0],d=s[1],h=Object(a.useCallback)((function(){return o.setFavorite(r,n)}),[o,r,n]),m=Object(a.useCallback)((function(){return o.unsetFavorite(r,n)}),[o,r,n]);return Object(a.useEffect)((function(){var e=function(e){e?r===e.circleId&&n===e.productId&&d(e.favorite):d(o.isFavorite(r,n))};return i&&o.on("change",e),i?function(){o.off("change",e)}:function(){}}),[i,o,r,n]),c.a.createElement("div",{style:{marginLeft:8},onClick:u?m:h},c.a.createElement(S.a,{icon:u?L.g:G.a,color:"#ffcc00",size:"lg"}))};var T=function(e){var t=e.eventId,r=e.circleId,n=Object(a.useCallback)((function(){window.open("https://techbookfest.org/event/".concat(t,"/circle/").concat(r))}),[t,r]);return c.a.createElement("div",{style:{marginLeft:8},onClick:n},c.a.createElement(S.a,{icon:L.f,color:"gray",size:"lg"}))};var A=function(e){var t=e.models,r=e.circleInfo,a=e.isCurrent,n=r&&r.circleCutImage||{url:"",width:0,height:1};return c.a.createElement("div",{className:"circle-card"},c.a.createElement(P.a,null,c.a.createElement(P.a.Header,null,c.a.createElement(D.a,{variant:"secondary"},(r.spaces||[])[0]),c.a.createElement("span",null,r.name||" "),c.a.createElement("span",{className:"spacer"}),c.a.createElement(T,{eventId:"tbf07",circleId:r&&r.id}),c.a.createElement(J,{key:"fav-".concat(r&&r.id),models:t,isCurrent:a,circleId:r&&r.id})),c.a.createElement("div",{style:{width:"100%",textAlign:"center",marginTop:"8px"}},n.url&&c.a.createElement(P.a.Img,{variant:"top",src:n.url,style:{width:200*n.width/n.height,height:200}}),!n.url&&c.a.createElement("div",{style:{display:"inline-block",width:141,height:200,border:"5px solid black",overflow:"hidden"}},c.a.createElement("div",{style:{top:"50%",position:"relative",marginTop:"-0.5em"}},"NO IMAGE"))),c.a.createElement(P.a.Body,null,c.a.createElement("div",{className:"card-text"},c.a.createElement(z.a,null,c.a.createElement(z.a.Group,{controlId:"name"},c.a.createElement(z.a.Label,null,"\u30b5\u30fc\u30af\u30eb\u540d"),c.a.createElement("div",{className:"form-control-plaintext"},r.nameRuby?"".concat(r.name,"(").concat(r.nameRuby,")"):r.name)),c.a.createElement(z.a.Group,{controlId:"spaces"},c.a.createElement(z.a.Label,null,"\u914d\u7f6e"),c.a.createElement("div",{className:"form-control-plaintext"},r.spaces&&r.spaces[0]||"")),c.a.createElement(z.a.Group,{controlId:"penName"},c.a.createElement(z.a.Label,null,"\u30da\u30f3\u30cd\u30fc\u30e0"),c.a.createElement("div",{className:"form-control-plaintext"},r.penName)),r.webSiteURL&&c.a.createElement(z.a.Group,{controlId:"webSiteURL"},c.a.createElement(z.a.Label,null,"Web\u30b5\u30a4\u30c8"),c.a.createElement("div",{className:"form-control-plaintext"},r.webSiteURL)),c.a.createElement(z.a.Group,{controlId:"genre"},c.a.createElement(z.a.Label,null,"\u30b8\u30e3\u30f3\u30eb"),c.a.createElement("div",{className:"form-control-plaintext"},r.genre)),c.a.createElement(z.a.Group,{controlId:"genreFreeFormat"},c.a.createElement(z.a.Label,null,"\u30b8\u30e3\u30f3\u30eb\u8a73\u7d30"),c.a.createElement("pre",{className:"form-control-plaintext",style:{whiteSpace:"pre-wrap"}},r.genreFreeFormat)))))))},U={fanzine:"\u540c\u4eba\u8a8c",commerce:"\u5546\u696d\u8a8c"},W=200;var H=function(e){var t=e.models,r=e.circleInfo,a=e.productInfo,n=e.isCurrent,i=a&&a.images&&a.images[0]||{url:"",width:0,height:1};return c.a.createElement("div",{className:"product-card"},c.a.createElement(P.a,null,c.a.createElement(P.a.Header,null,c.a.createElement(D.a,{variant:"secondary"},(r.spaces||[])[0]),c.a.createElement("span",null,r.name||" "),c.a.createElement("span",{className:"spacer"}),c.a.createElement(T,{eventId:"tbf07",circleId:r&&r.id}),c.a.createElement(J,{key:"fav-".concat(r&&r.id,"-").concat(a&&a.id),models:t,isCurrent:n,circleId:r&&r.id,productId:a&&a.id})),!1,c.a.createElement("div",{style:{width:"100%",height:W,marginTop:"8px",display:"flex",justifyContent:"center",alignItems:"center"}},i.url&&c.a.createElement(P.a.Img,{variant:"top",src:i.url,style:Object.assign({},i.width<i.height?{width:i.width*W/i.height,height:W}:{width:W,height:i.height*W/i.width})})),c.a.createElement(P.a.Body,null,c.a.createElement("div",{className:"card-text"},c.a.createElement(z.a,null,c.a.createElement(z.a.Group,{controlId:"name"},c.a.createElement(z.a.Label,null,"\u9812\u5e03\u7269"),c.a.createElement("div",{className:"form-control-plaintext"},a.name)),c.a.createElement(z.a.Group,{controlId:"page"},c.a.createElement(z.a.Label,null,"\u7a2e\u985e / \u30da\u30fc\u30b8 / \u4fa1\u683c"),c.a.createElement("div",{className:"form-control-plaintext"},[U[a.type],a.page?"".concat(a.page," \u30da\u30fc\u30b8"):"\u30da\u30fc\u30b8\u6570\u4e0d\u660e",void 0!==a.price?"".concat(a.price," \u5186"):"\u4fa1\u683c\u4e0d\u660e"].join(" / "))),c.a.createElement(z.a.Group,{controlId:"firstAppearanceEventName"},c.a.createElement(z.a.Label,null,"\u521d\u51fa"),c.a.createElement("div",{className:"form-control-plaintext"},a.firstAppearanceEventName)),c.a.createElement(z.a.Group,{controlId:"description"},c.a.createElement(z.a.Label,null,"\u6982\u8981"),c.a.createElement("pre",{className:"form-control-plaintext",style:{whiteSpace:"pre-wrap"}},a.description)))))))},K=r(146),$=r(141);var M=function(){return c.a.createElement("div",{className:"circle-card"},c.a.createElement(K.a,null,c.a.createElement(K.a.Header,null,c.a.createElement("span",null,"\xa0"),c.a.createElement("span",{className:"spacer"}),c.a.createElement(S.a,{icon:L.f,color:"gray",size:"lg",style:{marginLeft:8}}),c.a.createElement(S.a,{icon:G.a,color:"gray",size:"lg",style:{marginLeft:8}})),c.a.createElement("div",{className:"loading"},c.a.createElement($.a,{animation:"border"}))))},Q=r(86),V=r(78),X=r(43),Y=r(85),Z=function(e){function t(e,r){var a;return Object(o.a)(this,t),(a=Object(Q.a)(this,Object(V.a)(t).call(this,e,r))).handleClick=a.handleClick.bind(Object(X.a)(a)),a}return Object(Y.a)(t,e),Object(l.a)(t,[{key:"handleClick",value:function(e){e.preventDefault(),this.props.onClick(e)}},{key:"render",value:function(){return c.a.createElement("a",{href:"#",onClick:this.handleClick},c.a.createElement(S.a,{icon:L.e,color:"gray",size:"2x"}))}}]),t}(c.a.Component);var ee=function(e){var t=e.models,r=e.history,n=e.params,i=t.circle,o=t.product,l=t.favorite,s=n.event,u=n.circleId,d=n.productId,h=Object(a.useState)(),m=Object(j.a)(h,2),f=(m[0],m[1]),v=Object(a.useState)(),p=Object(j.a)(v,2),g=p[0],E=p[1],b=Object(a.useState)(),y=Object(j.a)(b,2),I=y[0],_=y[1],k=Object(a.useState)(),C=Object(j.a)(k,2),O=C[0],w=C[1],x=Object(a.useCallback)((function(){r.push("/fav/list")}),[r]),q=Object(a.useCallback)((function(){l.export()}),[l]),P=Object(a.useCallback)((function(){r.push("/fav/import")}),[l,r]),F=Object(a.useCallback)((function(){i.clearCache(),o.clearCache()}),[i,o]);Object(a.useEffect)((function(){var e=i.getCircle(u);e?E(e):i.request({circleId:u}),o.getProductList(u)?_(I):o.request({circleId:u})}),[i,u,o,I]),Object(a.useEffect)((function(){if(u){var e=o.getProduct(u,d);e?w(e):o.request({circleId:u})}}),[u,o,d]),Object(a.useEffect)((function(){var e=function(){if(u)f(i.getCircleListOrderByBooth()),E(i.getCircle(u)),_(o.getProductList(u)),w(o.getProduct(u,d));else{var e=i.getFirstBooth();e&&r.replace("/".concat(s,"/circle/").concat(e.id))}},t=function(){f(i.getCircleListOrderByBooth()),E(i.getCircle(u)),_(o.getProductList(u)),w(o.getProduct(u,d))},a=function(){_(o.getProductList(u)),w(o.getProduct(u,d))},c=function(){_(o.getProductList(u)),w(o.getProduct(u,d))};return i.on("change",e),i.on("loaded",t),o.on("change",a),o.on("loaded",c),function(){i.off("change",e),i.off("loaded",t),o.off("change",a),o.off("loaded",c)}}),[s,i,o,u,d,r]);var D=g||{id:u},R=O||{id:d};return c.a.createElement("div",{className:"card-container"},[c.a.createElement(M,null),c.a.createElement(A,{key:"_".concat(u),isCurrent:!0,models:t,circleInfo:D}),c.a.createElement(H,{key:"_".concat(u,"_").concat(d),isCurrent:!0,models:t,circleInfo:D,productInfo:R})][g?O&&O.name?2:1:0],c.a.createElement(B.a,{className:"card-menu-btn"},c.a.createElement(B.a.Toggle,{as:Z,id:"dropdown-custom-components"}),c.a.createElement(B.a.Menu,null,c.a.createElement(B.a.Item,{eventKey:"1",onSelect:x},"\u304a\u6c17\u306b\u5165\u308a\u4e00\u89a7"),c.a.createElement(B.a.Divider,null),c.a.createElement(B.a.Item,{eventKey:"2",onSelect:q},"\u304a\u6c17\u306b\u5165\u308a\u3092\u30a8\u30af\u30b9\u30dd\u30fc\u30c8"),c.a.createElement(B.a.Item,{eventKey:"3",onSelect:P},"\u304a\u6c17\u306b\u5165\u308a\u3092\u30a4\u30f3\u30dd\u30fc\u30c8"),c.a.createElement(B.a.Divider,null),c.a.createElement(B.a.Item,{eventKey:"3",onSelect:F},"\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u30af\u30ea\u30a2"))),c.a.createElement(N.a,{variant:"link",className:"circle-prev"+(g&&i.hasPrevCircle(u)?"":" btn-hidden"),onClick:function(){var e=i.getPrevCircleId(u);e&&r.push("/".concat(s,"/circle/").concat(e))}},c.a.createElement(S.a,{icon:L.b,color:"gray",size:"3x"})),c.a.createElement(N.a,{variant:"link",className:"circle-next"+(g&&i.hasNextCircle(u)?"":" btn-hidden"),onClick:function(){var e=i.getNextCircleId(u);e&&r.push("/".concat(s,"/circle/").concat(e))}},c.a.createElement(S.a,{icon:L.c,color:"gray",size:"3x"})),c.a.createElement(N.a,{variant:"link",className:"product-prev"+(d?"":" btn-hidden"),onClick:function(){var e=o.getPrevSiblings(u,d);r.push(e?"/".concat(s,"/circle/").concat(u,"/").concat(e.id):"/".concat(s,"/circle/").concat(u))}},c.a.createElement(S.a,{icon:L.d,color:"gray",size:"3x"})),c.a.createElement(N.a,{variant:"link",className:"product-next"+(o.hasNextProduct(u,d)?"":" btn-hidden"),onClick:function(){var e=o.getNextSiblings(u,d);r.push(e?"/".concat(s,"/circle/").concat(u,"/").concat(e.id):"/".concat(s,"/circle/").concat(u))}},c.a.createElement(S.a,{icon:L.a,color:"gray",size:"3x"})))},te=r(142),re=r(84),ae=(r(121),r(144));var ce=function(e){var t=e.title,r=e.message,n=e.onClose,i=Object(a.useState)(!!r),o=Object(j.a)(i,2),l=o[0],s=o[1];Object(a.useEffect)((function(){s(!!r)}),[r]);var u=Object(a.useCallback)((function(){s(!1),n&&n()}),[n]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(ae.a,{show:l,onHide:u},c.a.createElement(ae.a.Header,{closeButton:!0},c.a.createElement(ae.a.Title,null,t)),c.a.createElement(ae.a.Body,null,r),c.a.createElement(ae.a.Footer,null,c.a.createElement(N.a,{variant:"primary",onClick:u},"\u4e86\u89e3"))))},ne="\u304a\u6c17\u306b\u5165\u308a\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\u306b\u6210\u529f\u3057\u307e\u3057\u305f",ie="\u304a\u6c17\u306b\u5165\u308a\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\u306b\u5931\u6557\u3057\u307e\u3057\u305f";var oe=function(e){var t=e.models,r=e.history,n=t.favorite,i=Object(a.useState)(!1),o=Object(j.a)(i,2),l=o[0],s=o[1],u=Object(re.a)({accept:"application/json"}),d=u.acceptedFiles,h=u.rejectedFiles,m=u.getRootProps,f=u.getInputProps,v=h.map((function(e){return c.a.createElement("li",{key:e.path},e.path," \u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002")})),p=Object(a.useCallback)((function(){if(!(d.length<1)){var e=d[0],t=new FileReader;t.onload=function(e){n.import(e.target.result)?s(ne):s(ie)},t.readAsText(e)}}),[d,n]),g=Object(a.useCallback)((function(){r.goBack()}),[r]),E=Object(a.useCallback)((function(){s(!1),r.goBack()}),[r]);return c.a.createElement("div",{className:"page-container"},c.a.createElement("h3",null,"\u304a\u6c17\u306b\u5165\u308a\u306e\u30a4\u30f3\u30dd\u30fc\u30c8"),c.a.createElement("div",m({className:"dropzone"}),c.a.createElement("input",f()),c.a.createElement("p",null,"\u3053\u3053\u3067\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3057\u305f\u304a\u6c17\u306b\u5165\u308a\u3092\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u304b\u3001\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044"),c.a.createElement("em",null,"(*.json \u306e\u307f\u6307\u5b9a\u53ef\u80fd)")),c.a.createElement("ol",null,v),c.a.createElement(te.a,null,c.a.createElement(N.a,{variant:"primary",onClick:p,disabled:d.length<1},"\u30a4\u30f3\u30dd\u30fc\u30c8"),c.a.createElement(N.a,{variant:"secondary",onClick:g},"\u623b\u308b")),c.a.createElement(ce,{title:"\u30a4\u30f3\u30dd\u30fc\u30c8",message:l,onClose:l===ne?E:function(){s(!1)}}))},le=r(143);var se=function(e){var t=e.history,r=e.models,n=r.circle,i=r.product,o=r.favorite,l=Object(a.useState)(o.list("tbf07")),s=Object(j.a)(l,2),u=s[0],d=s[1],h=Object(a.useState)({price:0,withUnknown:!1}),m=Object(j.a)(h,2),f=m[0],v=m[1];Object(a.useEffect)((function(){var e=function(){var e=o.list("tbf07");n.mergeFavorite(e),i.mergeFavorite(e),d(e),v(e.reduce((function(e,t){return t.productId&&(void 0===t.productPrice?e.withUnknown=!0:e.price+=t.productPrice),e}),{price:0,withUnknown:!1}))};return n.on("change",e),n.on("loaded",e),i.on("change",e),i.on("loaded",e),o.on("change",e),function(){n.off("change",e),n.off("loaded",e),i.off("change",e),i.off("loaded",e),o.off("change",e)}}),[n,i,o]);var p=Object(a.useCallback)((function(){t.goBack()}),[t]);return c.a.createElement("div",{className:"page-container"},c.a.createElement("h3",null,"\u304a\u6c17\u306b\u5165\u308a\u4e00\u89a7"),c.a.createElement(le.a,{className:"fav-list",striped:!0,bordered:!0,size:"sm"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",{className:"circle-space"},"\u914d\u7f6e"),c.a.createElement("th",{className:"circle-name"},"\u30b5\u30fc\u30af\u30eb\u540d"),c.a.createElement("th",{className:"product-name"},"\u9812\u5e03\u7269"),c.a.createElement("th",{className:"product-price"},"\u4fa1\u683c"))),c.a.createElement("tbody",null,u.map((function(e,r){return c.a.createElement("tr",{key:"fav-".concat(e.circleId,"-").concat("circle"|e.productId)},c.a.createElement("td",{className:"circle-space"},c.a.createElement(N.a,{variant:"link",style:{padding:0},onClick:function(){e.productId?t.push("/".concat(e.eventId.replace(/^[a-z]+0*/,""),"/circle/").concat(e.circleId,"/").concat(e.productId)):t.push("/".concat(e.eventId.replace(/^[a-z]+0*/,""),"/circle/").concat(e.circleId))}},e.space||"")),c.a.createElement("td",{className:"circle-name"},e.circleName||""),c.a.createElement("td",{className:"product-name"},e.productName||""),c.a.createElement("td",{className:"product-price"},void 0===e.productPrice?"":"".concat(e.productPrice," \u5186")))}))),c.a.createElement("tfoot",null,c.a.createElement("tr",null,c.a.createElement("th",{className:"circle-space"},"\u5408\u8a08"),c.a.createElement("td",{colSpan:3,className:"product-price"},"".concat(f.price," \u5186").concat(f.withUnknown?" \u203b\u4e0d\u660e\u542b\u3080":""))))),c.a.createElement(te.a,null,c.a.createElement(N.a,{variant:"secondary",onClick:p},"\u623b\u308b")))};var ue=function(e){var t=e.models;return c.a.createElement(C.HashRouter,null,c.a.createElement(O.d,{path:"/",exact:!0,render:function(e){return c.a.createElement(x,{models:t,history:e.history,params:e.match.params})}}),c.a.createElement(O.d,{path:"/:event/circle/:circleId?/:productId?",render:function(e){return c.a.createElement(ee,{models:t,history:e.history,params:e.match.params})}}),c.a.createElement(O.d,{path:"/fav/import",render:function(e){return c.a.createElement(oe,{models:t,history:e.history})}}),c.a.createElement(O.d,{path:"/fav/list",render:function(e){return c.a.createElement(se,{models:t,history:e.history})}}))},de={circle:new v,product:new E,favorite:new k};de.circle.request(),i.a.render(c.a.createElement(ue,{models:de}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},87:function(e,t,r){e.exports=r(138)},93:function(e,t,r){},95:function(e,t,r){}},[[87,1,2]]]);
//# sourceMappingURL=main.532bae78.chunk.js.map