(window["webpackJsonptbf-checklist"]=window["webpackJsonptbf-checklist"]||[]).push([[0],{119:function(e,t,r){"use strict";r.r(t);var c=r(0),n=r.n(c),a=r(11),o=r.n(a);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r(83),r(84);var i=r(19),s=r(20),l=r(37),u=/^(.+?)([0-9]+)(.*)$/,d="circle-cache",h="c:";function f(e){var t=[].concat(u.exec(e)||["",0,""]).slice(1),r=t[0].codePointAt(0);return 1e3*(12353<=r&&r<=12435?r-12353+10:["\u904b","\u5354"].indexOf(t[0]))+ +t[1]}var v=function(){function e(){Object(i.a)(this,e),this._event=new l,this._waitRequest={},this._waitRequestList=!1,this._store=this._getDefault(),sessionStorage.removeItem(d);for(var t=0;t<sessionStorage.length;t++)try{var r=sessionStorage.key(t);if(h===r.substr(0,h.length)){var c=JSON.parse(sessionStorage.getItem(r));c&&c.id&&this._updateCircle(c,!0)}}catch(n){}this._store.orderBy.booth=this._store.orderBy.booth.sort((function(e,t){return f(e)-f(t)}))}return Object(s.a)(e,[{key:"_getDefault",value:function(){return{loadCompleted:!1,orderBy:{booth:[]},lookupBy:{booth:{}},circles:{}}}},{key:"_updateCircle",value:function(e,t){delete e.event,delete e.eventExhibitCourse,this._store.circles[e.id]=e;for(var r,c=0;void 0!==(r=e.spaces[c]);++c)this._store.lookupBy.booth[r]=e.id,this._store.orderBy.booth.indexOf(r)<0&&this._store.orderBy.booth.push(r);t||sessionStorage.setItem(h+e.id,JSON.stringify(e))}},{key:"request",value:function(e){}},{key:"on",value:function(e,t){this._event.on(e,t),0<=["change","loaded"].indexOf(e)&&!1===this._waitRequestList&&t(e)}},{key:"off",value:function(e,t){this._event.removeListener(e,t)}},{key:"getCircleListOrderByBooth",value:function(){var e=this;return(this._store.orderBy.booth||[]).map((function(t){return(e.getCircleByBooth(t)||{}).id}))}},{key:"getCircleByBooth",value:function(e){return this._store.circles[this._store.lookupBy.booth[e]]}},{key:"getCircleBoothOrder",value:function(e){return!1!==this._waitRequestList?-2:this._store.orderBy.booth.indexOf(((this._store.circles[e]||{}).spaces||[])[0])}},{key:"getCircle",value:function(e){return this._store.circles[e]}},{key:"getFirstBooth",value:function(){return!1===this._waitRequestList&&this.getCircleByBooth(this._store.orderBy.booth[0])}},{key:"getLastBooth",value:function(){return!1===this._waitRequestList&&this.getCircleByBooth(this._store.orderBy.booth[this._store.orderBy.booth.length-1])}},{key:"hasPrevCircle",value:function(e){var t=this._store.circles[e];return!(!t||!t.prevCircleExhibitInfoID)}},{key:"hasNextCircle",value:function(e){var t=this._store.circles[e];return!(!t||!t.nextCircleExhibitInfoID)}},{key:"getPrevCircle",value:function(e){var t=this._store.circles[e];return t&&t.prevCircleExhibitInfoID&&this._store.circles[t.prevCircleExhibitInfoID]}},{key:"getNextCircle",value:function(e){var t=this._store.circles[e];return t&&t.nextCircleExhibitInfoID&&this._store.circles[t.nextCircleExhibitInfoID]}},{key:"getPrevCircleId",value:function(e){var t=this._store.circles[e];return t&&t.prevCircleExhibitInfoID}},{key:"getNextCircleId",value:function(e){var t=this._store.circles[e];return t&&t.nextCircleExhibitInfoID}},{key:"mergeFavorite",value:function(e){var t=this,r={};e.forEach((function(e){if(e.circleId){var c=t._store.circles[e.circleId];if(!c)return e.circleName=e.circleId,void(r[e.circleId]=!0);e.space=c.spaces[0],e.circleName=c.name}})),Object.keys(r).forEach((function(e){t.request({circleId:e})}))}},{key:"clearCache",value:function(){for(var e=0;e<sessionStorage.length;e++){var t=sessionStorage.key(e);h===t.substr(0,h.length)&&sessionStorage.removeItem(t)}this._store=this._getDefault(),this._event.emit("change")}}]),e}(),m=r(37),p="p:",g=function(){function e(){Object(i.a)(this,e),this._event=new m,this._store=this._getDefault(),this._reqWait={};for(var t=0;t<sessionStorage.length;t++)try{var r=sessionStorage.key(t);if(p===r.substr(0,p.length)){var c=JSON.parse(sessionStorage.getItem(r));c&&c.id&&this._updateCircle(c,!0)}}catch(n){}}return Object(s.a)(e,[{key:"request",value:function(e){}},{key:"_getDefault",value:function(){return{orderBy:{seq:{}},products:{}}}},{key:"_updateCircle",value:function(e,t){var r=e.circleExhibitInfoID;this._store.products[r]=this._store.products[r]||{},this._store.products[r][e.id]=e,this._store.orderBy.seq[r]=this._store.orderBy.seq[r]||[],this._store.orderBy.seq[r][e.seq-1]=e.id,t||sessionStorage.setItem(p+e.id,JSON.stringify(e))}},{key:"on",value:function(e,t){this._event.on(e,t)}},{key:"off",value:function(e,t){this._event.removeListener(e,t)}},{key:"getProductOrder",value:function(e,t){var r=this._store.orderBy.seq[e]||[];return r?r.indexOf(t):-1}},{key:"getProductList",value:function(e){var t=this._store.products[e];return t&&Object.keys(t)}},{key:"getProductByIndex",value:function(e,t){return(this._store.products[e]||{})[(this._store.orderBy.seq[e]||[])[t]]||!1}},{key:"getProduct",value:function(e,t){return(this._store.products[e]||{})[t]||!1}},{key:"getProductCount",value:function(e){var t=this._store.orderBy.seq[e];return t?t.length:-1}},{key:"hasNextProduct",value:function(e,t){var r=this._store.orderBy.seq[e],c=r&&r.indexOf(t);return!(!r||!r[c+1])}},{key:"getPrevSiblings",value:function(e,t){var r=this._store.products[e],c=this._store.orderBy.seq[e],n=c&&c.indexOf(t);return c&&r[c[n-1]]||!1}},{key:"getNextSiblings",value:function(e,t){var r=this._store.products[e],c=this._store.orderBy.seq[e],n=c&&c.indexOf(t);return c&&r[c[n+1]]||!1}},{key:"mergeFavorite",value:function(e){var t=this,r={};e.forEach((function(e){if(e.circleId&&e.productId){var c=(t._store.products[e.circleId]||{})[e.productId];if(!c)return e.productName=e.productId,void(r[e.circleId]=!0);e.productName=c.name,e.productPrice=c.price}})),Object.keys(r).forEach((function(e){t.request({circleId:e})}))}},{key:"clearCache",value:function(){for(var e=0;e<sessionStorage.length;e++){var t=sessionStorage.key(e);p===t.substr(0,p.length)&&sessionStorage.removeItem(t)}this._store=this._getDefault(),this._event.emit("change")}}]),e}(),b=r(49),y=r(37),_=r(85),E="favorite",k=function(){function e(){Object(i.a)(this,e),this._event=new y,this._store=JSON.parse(localStorage.getItem(E)||"{}")}return Object(s.a)(e,[{key:"on",value:function(e,t){this._event.on(e,t)}},{key:"off",value:function(e,t){this._event.removeListener(e,t)}},{key:"isFavorite",value:function(e,t){return!!(t?this._store.tbf07&&this._store.tbf07[e]&&this._store.tbf07[e][t]:this._store.tbf07&&this._store.tbf07[e]&&this._store.tbf07[e].circle)}},{key:"setFavorite",value:function(e,t){if(e){this._store.tbf07=this._store.tbf07||{},this._store.tbf07[e]=this._store.tbf07[e]||Object(b.a)({},"circle",null);var r=t||"circle",c=!0!==this._store.tbf07[e][r];this._store.tbf07[e][r]=!0,c&&(localStorage.setItem(E,JSON.stringify(this._store)),this._event.emit("change",{circleId:e,productId:t,favorite:!0}))}}},{key:"unsetFavorite",value:function(e,t){if(e){this._store.tbf07=this._store.tbf07||{},this._store.tbf07[e]=this._store.tbf07[e]||Object(b.a)({},"circle",null);var r=t||"circle",c=!0===this._store.tbf07[e][r];delete this._store.tbf07[e][r],c&&(localStorage.setItem(E,JSON.stringify(this._store)),this._event.emit("change",{circleId:e,productId:t,favorite:!1}))}}},{key:"export",value:function(){_(JSON.stringify(this._store),"favorite.json")}},{key:"import",value:function(e){try{var t=JSON.parse(e);return this._store=t,localStorage.setItem(E,JSON.stringify(this._store)),this._event.emit("change"),!0}catch(r){return console.debug(r),!1}}},{key:"list",value:function(e){var t=[],r={},c=this._store[e]||{};for(var n in c){var a=c[n]||{};for(var o in a)a[o]&&("circle"===o?t.push({eventId:"tbf07",circleId:n}):(t.push({eventId:"tbf07",circleId:n,productId:o}),r[n]=!0))}return t=t.reduce((function(e,t){return!t.productId&&r[t.circleId]||e.push(t),e}),[])}}]),e}(),I=r(29),O=r(21),C=(r(86),r(66)),j=r(64);var B=function(){return n.a.createElement("div",null,n.a.createElement(O.c,{to:"/7/circle/"}),n.a.createElement(j.LinkContainer,{to:"/7/circle/"},n.a.createElement(C.a,null,"\u6280\u8853\u66f8\u5178\uff17")))},S=r(13),N=r(125),w=r(31),x=r(32),P=r(126);r(95);var q=function(){return n.a.createElement("div",{className:"circle-card"},n.a.createElement(P.a,null,n.a.createElement(P.a.Header,null,"\u9589\u9396\u3055\u308c\u307e\u3057\u305f"),n.a.createElement("div",{className:"loading"},n.a.createElement("p",null,"\u8af8\u4e8b\u60c5\u306b\u3088\u308a\u3053\u306e\u30b5\u30a4\u30c8\u306f\u9589\u9396\u3055\u308c\u307e\u3057\u305f\u3002"),n.a.createElement("p",null,"\u30e1\u30cb\u30e5\u30fc\u3088\u308a\u3001\u304a\u6c17\u306b\u5165\u308a\u4e00\u89a7\u306e\u8868\u793a\u3001\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u306e\u307f\u53ef\u80fd\u3067\u3059\u3002"),n.a.createElement("p",null,"\u30b5\u30fc\u30af\u30eb\u540d\u306a\u3069\u306f\u30ad\u30e3\u30c3\u30b7\u30e5\u306b\u6b8b\u3063\u3066\u3044\u308b\u5834\u5408\u306b\u306e\u307f\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),n.a.createElement("p",null,"\u3054\u8ff7\u60d1\u3092\u304a\u304b\u3051\u3044\u305f\u3057\u307e\u3059\u304c\u3001\u3054\u7406\u89e3\u306e\u7a0b\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u7533\u3057\u4e0a\u3052\u307e\u3059\u3002"))))},L=r(76),D=r(68),F=r(33),J=r(77),R=function(e){function t(e,r){var c;return Object(i.a)(this,t),(c=Object(L.a)(this,Object(D.a)(t).call(this,e,r))).handleClick=c.handleClick.bind(Object(F.a)(c)),c}return Object(J.a)(t,e),Object(s.a)(t,[{key:"handleClick",value:function(e){e.preventDefault(),this.props.onClick(e)}},{key:"render",value:function(){return n.a.createElement("a",{href:"#",onClick:this.handleClick},n.a.createElement(w.a,{icon:x.a,color:"gray",size:"2x"}))}}]),t}(n.a.Component);var z=function(e){var t=e.models,r=e.history,a=e.params,o=t.circle,i=t.product,s=t.favorite,l=a.event,u=a.circleId,d=a.productId,h=Object(c.useState)(),f=Object(S.a)(h,2),v=(f[0],f[1]),m=Object(c.useState)(),p=Object(S.a)(m,2),g=(p[0],p[1]),b=Object(c.useState)(),y=Object(S.a)(b,2),_=y[0],E=y[1],k=Object(c.useState)(),I=Object(S.a)(k,2),O=(I[0],I[1]),C=Object(c.useCallback)((function(){r.push("/fav/list")}),[r]),j=Object(c.useCallback)((function(){s.export()}),[s]),B=Object(c.useCallback)((function(){r.push("/fav/import")}),[s,r]),w=Object(c.useCallback)((function(){o.clearCache(),i.clearCache()}),[o,i]);return Object(c.useEffect)((function(){var e=o.getCircle(u);e?g(e):o.request({circleId:u}),i.getProductList(u)?E(_):i.request({circleId:u})}),[o,u,i,_]),Object(c.useEffect)((function(){if(u){var e=i.getProduct(u,d);e?O(e):i.request({circleId:u})}}),[u,i,d]),Object(c.useEffect)((function(){var e=function(){if(u)v(o.getCircleListOrderByBooth()),g(o.getCircle(u)),E(i.getProductList(u)),O(i.getProduct(u,d));else{var e=o.getFirstBooth();e&&r.replace("/".concat(l,"/circle/").concat(e.id))}},t=function(){v(o.getCircleListOrderByBooth()),g(o.getCircle(u)),E(i.getProductList(u)),O(i.getProduct(u,d))},c=function(){E(i.getProductList(u)),O(i.getProduct(u,d))},n=function(){E(i.getProductList(u)),O(i.getProduct(u,d))};return o.on("change",e),o.on("loaded",t),i.on("change",c),i.on("loaded",n),function(){o.off("change",e),o.off("loaded",t),i.off("change",c),i.off("loaded",n)}}),[l,o,i,u,d,r]),n.a.createElement("div",{className:"card-container"},n.a.createElement(q,null),n.a.createElement(N.a,{className:"card-menu-btn"},n.a.createElement(N.a.Toggle,{as:R,id:"dropdown-custom-components"}),n.a.createElement(N.a.Menu,null,n.a.createElement(N.a.Item,{eventKey:"1",onSelect:C},"\u304a\u6c17\u306b\u5165\u308a\u4e00\u89a7"),n.a.createElement(N.a.Divider,null),n.a.createElement(N.a.Item,{eventKey:"2",onSelect:j},"\u304a\u6c17\u306b\u5165\u308a\u3092\u30a8\u30af\u30b9\u30dd\u30fc\u30c8"),n.a.createElement(N.a.Item,{eventKey:"3",onSelect:B,disabled:!0},"\u304a\u6c17\u306b\u5165\u308a\u3092\u30a4\u30f3\u30dd\u30fc\u30c8"),n.a.createElement(N.a.Divider,null),n.a.createElement(N.a.Item,{eventKey:"3",onSelect:w},"\u30ad\u30e3\u30c3\u30b7\u30e5\u3092\u30af\u30ea\u30a2"))))},H=r(122),K=r(75),U=(r(102),r(124));var T=function(e){var t=e.title,r=e.message,a=e.onClose,o=Object(c.useState)(!!r),i=Object(S.a)(o,2),s=i[0],l=i[1];Object(c.useEffect)((function(){l(!!r)}),[r]);var u=Object(c.useCallback)((function(){l(!1),a&&a()}),[a]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(U.a,{show:s,onHide:u},n.a.createElement(U.a.Header,{closeButton:!0},n.a.createElement(U.a.Title,null,t)),n.a.createElement(U.a.Body,null,r),n.a.createElement(U.a.Footer,null,n.a.createElement(C.a,{variant:"primary",onClick:u},"\u4e86\u89e3"))))},W="\u304a\u6c17\u306b\u5165\u308a\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\u306b\u6210\u529f\u3057\u307e\u3057\u305f",A="\u304a\u6c17\u306b\u5165\u308a\u306e\u30a4\u30f3\u30dd\u30fc\u30c8\u306b\u5931\u6557\u3057\u307e\u3057\u305f";var $=function(e){var t=e.models,r=e.history,a=t.favorite,o=Object(c.useState)(!1),i=Object(S.a)(o,2),s=i[0],l=i[1],u=Object(K.a)({accept:"application/json"}),d=u.acceptedFiles,h=u.rejectedFiles,f=u.getRootProps,v=u.getInputProps,m=h.map((function(e){return n.a.createElement("li",{key:e.path},e.path," \u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002")})),p=Object(c.useCallback)((function(){if(!(d.length<1)){var e=d[0],t=new FileReader;t.onload=function(e){a.import(e.target.result)?l(W):l(A)},t.readAsText(e)}}),[d,a]),g=Object(c.useCallback)((function(){r.goBack()}),[r]),b=Object(c.useCallback)((function(){l(!1),r.goBack()}),[r]);return n.a.createElement("div",{className:"page-container"},n.a.createElement("h3",null,"\u304a\u6c17\u306b\u5165\u308a\u306e\u30a4\u30f3\u30dd\u30fc\u30c8"),n.a.createElement("div",f({className:"dropzone"}),n.a.createElement("input",v()),n.a.createElement("p",null,"\u3053\u3053\u3067\u30a8\u30af\u30b9\u30dd\u30fc\u30c8\u3057\u305f\u304a\u6c17\u306b\u5165\u308a\u3092\u30c9\u30e9\u30c3\u30b0\uff06\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u304b\u3001\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044"),n.a.createElement("em",null,"(*.json \u306e\u307f\u6307\u5b9a\u53ef\u80fd)")),n.a.createElement("ol",null,m),n.a.createElement(H.a,null,n.a.createElement(C.a,{variant:"primary",onClick:p,disabled:d.length<1},"\u30a4\u30f3\u30dd\u30fc\u30c8"),n.a.createElement(C.a,{variant:"secondary",onClick:g},"\u623b\u308b")),n.a.createElement(T,{title:"\u30a4\u30f3\u30dd\u30fc\u30c8",message:s,onClose:s===W?b:function(){l(!1)}}))},M=r(123);var G=function(e){var t=e.history,r=e.models,a=r.circle,o=r.product,i=r.favorite,s=Object(c.useState)(i.list("tbf07")),l=Object(S.a)(s,2),u=l[0],d=l[1],h=Object(c.useState)({price:0,withUnknown:!1}),f=Object(S.a)(h,2),v=f[0],m=f[1];Object(c.useEffect)((function(){var e=function(){var e=i.list("tbf07");a.mergeFavorite(e),o.mergeFavorite(e),d(e),m(e.reduce((function(e,t){return t.productId&&(void 0===t.productPrice?e.withUnknown=!0:e.price+=t.productPrice),e}),{price:0,withUnknown:!1}))};return a.on("change",e),a.on("loaded",e),o.on("change",e),o.on("loaded",e),i.on("change",e),function(){a.off("change",e),a.off("loaded",e),o.off("change",e),o.off("loaded",e),i.off("change",e)}}),[a,o,i]);var p=Object(c.useCallback)((function(){t.goBack()}),[t]);return n.a.createElement("div",{className:"page-container"},n.a.createElement("h3",null,"\u304a\u6c17\u306b\u5165\u308a\u4e00\u89a7"),n.a.createElement(M.a,{className:"fav-list",striped:!0,bordered:!0,size:"sm"},n.a.createElement("thead",null,n.a.createElement("tr",null,n.a.createElement("th",{className:"circle-space"},"\u914d\u7f6e"),n.a.createElement("th",{className:"circle-name"},"\u30b5\u30fc\u30af\u30eb\u540d"),n.a.createElement("th",{className:"product-name"},"\u9812\u5e03\u7269"),n.a.createElement("th",{className:"product-price"},"\u4fa1\u683c"))),n.a.createElement("tbody",null,u.map((function(e,r){return n.a.createElement("tr",{key:"fav-".concat(e.circleId,"-").concat("circle"|e.productId)},n.a.createElement("td",{className:"circle-space"},n.a.createElement(C.a,{variant:"link",style:{padding:0},onClick:function(){e.productId?t.push("/".concat(e.eventId.replace(/^[a-z]+0*/,""),"/circle/").concat(e.circleId,"/").concat(e.productId)):t.push("/".concat(e.eventId.replace(/^[a-z]+0*/,""),"/circle/").concat(e.circleId))}},e.space||"")),n.a.createElement("td",{className:"circle-name"},e.circleName||""),n.a.createElement("td",{className:"product-name"},e.productName||""),n.a.createElement("td",{className:"product-price"},void 0===e.productPrice?"":"".concat(e.productPrice," \u5186")))}))),n.a.createElement("tfoot",null,n.a.createElement("tr",null,n.a.createElement("th",{className:"circle-space"},"\u5408\u8a08"),n.a.createElement("td",{colSpan:3,className:"product-price"},"".concat(v.price," \u5186").concat(v.withUnknown?" \u203b\u4e0d\u660e\u542b\u3080":""))))),n.a.createElement(H.a,null,n.a.createElement(C.a,{variant:"secondary",onClick:p},"\u623b\u308b")))};var Q=function(e){var t=e.models;return n.a.createElement(I.HashRouter,null,n.a.createElement(O.d,{path:"/",exact:!0,render:function(e){return n.a.createElement(B,{models:t,history:e.history,params:e.match.params})}}),n.a.createElement(O.d,{path:"/:event/circle/:circleId?/:productId?",render:function(e){return n.a.createElement(z,{models:t,history:e.history,params:e.match.params})}}),n.a.createElement(O.d,{path:"/fav/import",render:function(e){return n.a.createElement($,{models:t,history:e.history})}}),n.a.createElement(O.d,{path:"/fav/list",render:function(e){return n.a.createElement(G,{models:t,history:e.history})}}))},V={circle:new v,product:new g,favorite:new k};V.circle.request(),o.a.render(n.a.createElement(Q,{models:V}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},78:function(e,t,r){e.exports=r(119)},84:function(e,t,r){},86:function(e,t,r){}},[[78,1,2]]]);
//# sourceMappingURL=main.b9778484.chunk.js.map